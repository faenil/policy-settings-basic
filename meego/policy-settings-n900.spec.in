%define _enable_debug_packages 0
%define _unpackaged_files_terminate_build 0

Summary: Precompiled basic MeeGo policy settings for the N900
Name: policy-settings-n900
Version: ##__VERSION__##
Release: 1
License: GPLv2
Group: System Environment/Configuration
URL: http://127.0.0.1
Source0: %{name}-%{version}.tar.gz
BuildArch: noarch
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
BuildRequires: libdres-utils
BuildRequires: swi-prolog, swi-prolog-lib
BuildRequires: libprolog, prolog-extensions
Requires: swi-prolog, swi-prolog-lib-core, libprolog, prolog-extensions
#Requires: ohm, ohm-plugins-misc, ohm-plugin-resolver, ohm-plugin-ruleengine
#Requires: pulseaudio-policy-enforcement

%description
Precompiled basic MeeGo policy settings for the N900.

%package text
Summary: Basic MeeGo policy settings sources for the N900
Group: System Environment/Configuration
Provides: policy-settings
Requires: swi-prolog, swi-prolog-lib-core, swi-prolog-lib
Requires: libprolog, prolog-extensions
#Requires: ohm, ohm-plugins-misc, ohm-plugin-resolver, ohm-plugin-ruleengine
#Requires: pulseaudio-policy-enforcement

%description text
Basic MeeGo policy settings sources for the N900.

%prep
%setup -q

%build
# Ouch... protect ourselves against bad karma from clock drift + autogen
find . -type f -exec touch {} \;
./autogen.sh
%configure
make

%install
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT
make DESTDIR=$RPM_BUILD_ROOT INSTALL_SYMLINKS=1 install

%clean
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root,-)
%{_datadir}/policy/etc/current
%{_datadir}/policy/rules/current
%{_sysconfdir}/ohm/*.ini
%{_sysconfdir}/ohm/plugins.d/*.ini
%dir %{_datadir}/policy/rules/basic
%{_datadir}/policy/rules/basic/*.plc
%{_datadir}/policy/rules/basic/*.dresc
%dir %{_datadir}/policy/etc/basic
%{_datadir}/policy/etc/basic/*.conf
%{_datadir}/policy/etc/basic/ohm
%{_datadir}/policy/etc/basic/pulse

%files text
%defattr(-,root,root,-)
%{_datadir}/policy/etc/current
%{_datadir}/policy/rules/current
%{_sysconfdir}/ohm/*.ini
%{_sysconfdir}/ohm/plugins.d/*.ini
%dir %{_datadir}/policy/rules/basic
%{_datadir}/policy/rules/basic/*.pl
%{_datadir}/policy/rules/basic/*.dres
%dir %{_datadir}/policy/etc/basic
%{_datadir}/policy/etc/basic/*.conf
%{_datadir}/policy/etc/basic/ohm
%{_datadir}/policy/etc/basic/pulse

%changelog
* Sun Dec 12 2010 Krisztian Litkey <krisztian.litkey@nokia.com> - 
- Initial build.
